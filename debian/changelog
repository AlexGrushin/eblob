eblob (0.12.15) unstable; urgency=low

  * Do not open index and data files again in eblob_iterate
  * Update unsorted indexes of removed records with BLOB_DISK_CTL_REMOVE flag
  * Use 50 millions of records in blob by default
  * Added eblob_merge (instead of old eblob_defrag) which defragments and
    merges (multiple) blobs into larger one

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 24 Oct 2011 18:31:03 +0400

eblob (0.12.14) unstable; urgency=low

  * Added bsearch statistics and on-disk lookup debugs
  * Use 40 indexes per range block. Use 128 bits per index for bloom.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 19 Oct 2011 20:51:23 +0400

eblob (0.12.13) unstable; urgency=low

  * Fixed sorted index bsearch range calculation

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 18 Oct 2011 18:41:25 +0400

eblob (0.12.12) unstable; urgency=low

  * Added bloom filter in sorted index blocks
  * Added tree for range index search

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 15 Oct 2011 05:36:21 +0400

eblob (0.12.11) unstable; urgency=low

  * Only read mapped data blob if EBLOB_ITERATE_FLAGS_ALL flag is set

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 12 Oct 2011 00:51:56 +0400

eblob (0.12.10) unstable; urgency=low

  * Returned offline defrag tool
  * Drop libssl deps
  * Check if record is removed in blob

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 11 Oct 2011 01:22:10 +0400

eblob (0.12.9) unstable; urgency=low

  * spec update
  * rename eblob.spec
  * use bz2 archive

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 03 Oct 2011 20:48:53 +0400

eblob (0.12.8) unstable; urgency=low

  * Use internal ctl iterator when truncating last record
  * Added initial data offset shift into eblob gen

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 30 Sep 2011 19:31:15 +0400

eblob (0.12.7) unstable; urgency=low

  * Fixed error checking in eblob_base_remove
  * Call iteration callback for old blobs when EBLOB_ITERATE_FLAGS_ALL is set

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 28 Sep 2011 19:16:14 +0400

eblob (0.12.6) unstable; urgency=low

  * If we have old entry, mark it removed always, not only when flag is set.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 27 Sep 2011 15:51:14 +0400

eblob (0.12.5) unstable; urgency=low

  * Added overwrite eblob flag
  * Only copy/splice old data into new chunk when append/overwrite flag is set

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 27 Sep 2011 01:03:47 +0400

eblob (0.12.4) unstable; urgency=low

  * Made eblob_gen_index embed-only

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 23 Sep 2011 18:07:21 +0400

eblob (0.12.3) unstable; urgency=low

  * Close race between sort lookups and uncompleted sort setup in bctl

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 21 Sep 2011 19:36:33 +0400

eblob (0.12.2) unstable; urgency=low

  * Added eblob_gen_index util to generate index files from data blobs
  * Extended debug in eblob helpers

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 21 Sep 2011 15:03:37 +0400

eblob (0.12.1) unstable; urgency=low

  * Use temporary offsets when iterating over blobs.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 15 Sep 2011 03:15:09 +0400

eblob (0.12.0) unstable; urgency=low

  * Implemented append write.
  * Added iteration flags

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 13 Sep 2011 00:27:25 +0400

eblob (0.11.2) unstable; urgency=low

  * Do not lock eblob_commit_ram()

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 09 Sep 2011 20:18:45 +0400

eblob (0.11.1) unstable; urgency=low

  * Fixed bug with on-disk index lookup
  * Added iterator in Python binding

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 06 Sep 2011 23:51:29 +0400

eblob (0.11.0) unstable; urgency=low

  * Get rid of unused config fields
  * Moved comparison function into include/eblob/blob.h
  * Initial error value in eblob_read_range_on_disk() should be 0
  * Added records_in_blob into cfg config which limits maximum number of
    records before blob is closed

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 31 Aug 2011 00:23:46 +0400

eblob (0.10.13) unstable; urgency=low

  * Use rb_prev() to iterate over tree in range request, since weRBtree is
    sorted in descending order
  * Set hash->rb_root to RB_ROOT prior its usage

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 30 Aug 2011 00:26:56 +0400

eblob (0.10.12) unstable; urgency=low

  * Added rbtree.h into library/Makefile.am
  * Revert "Always read eblob_disk_control from data_fd in
    eblob_fill_write_control_from_ram()"

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sun, 28 Aug 2011 05:27:09 +0400

eblob (0.10.11) unstable; urgency=low

  * Always account for on-disk entries
  * Switched from hash table to rbtree to store keys

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 26 Aug 2011 00:40:28 +0400

eblob (0.10.10) unstable; urgency=low

  * Added EBLOB_TRY_OVERWRITE hash_flags flag. We try to overwrite data only
    when it is set or for EBLOB_TYPE_META writes
  * Always read eblob_disk_control from data_fd in
    eblob_fill_write_control_from_ram()
  * When updating index, put there wc->flags without BLOB_DISK_CTL_REMOVE set.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 23 Aug 2011 04:59:39 +0400

eblob (0.10.9) unstable; urgency=low

  * If sorted index size does not match unsorted, remove and regenerate sorted
    index.
  * Fixed write-control-back for compressed data.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 23 Aug 2011 04:06:38 +0400

eblob (0.10.8) unstable; urgency=low

  * Use eblob_iterate_control->thread_num to indicate threads exiting, for
    example when file iteration completes
  * Remove key from hash table, if it happend to point to removed entry
  * Added NOTICE debug about eblob_read() result: data/index fd, offset, size
    and so on
  * Added paranoidal check into eblob_read(), which checks that index read
    from disk is not marked as removed.
  * Added id search into eblob_index_info structure
  * Extended regex matched info

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 18 Aug 2011 18:56:23 +0400

eblob (0.10.7) unstable; urgency=low

  * workaround for old indexes, which did not set dc.disk_size

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 12 Aug 2011 23:15:45 +0400

eblob (0.10.6) unstable; urgency=low

  * Added extensive error debug for E2BIG error in
    eblob_fill_write_control_from_ram()

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 12 Aug 2011 23:05:45 +0400

eblob (0.10.5) unstable; urgency=low

  * If eblob_fill_write_control_from_ram() read disk control from index and
    its data_size or disk_size are 0, reread it from data blob

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 12 Aug 2011 20:05:23 +0400

eblob (0.10.4) unstable; urgency=low

  * Update data header in overwrite
  * Read ctl from index when reading, since overwrite does not update data
    header

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 11 Aug 2011 23:35:36 +0400

eblob (0.10.3) unstable; urgency=low

  * Fixed nasty bug in alignment calculation, which may lead to unability to
    read data. Also need to copy write_control even in overwrite case

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 11 Aug 2011 04:30:14 +0400

eblob (0.10.2) unstable; urgency=low

  * Added BLOB_DISK_CTL_WRITE_RETURN flag, which specifies whether
    eblob_write_control should be copied back into data

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 11 Aug 2011 02:35:49 +0400

eblob (0.10.1) unstable; urgency=low

  * We should check key first, since second loop in eblob_find_on_disk()
    starts with different key
  * Propagate key into RAM if we read it from disk
  * Added eblob_regex_iter into bin_PROGRAMS
  * Added utility eblob_index_info
  * Added python binding

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 10 Aug 2011 23:12:55 +0400

eblob (0.10.0) unstable; urgency=low

  * Added stat support

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 10 Aug 2011 05:49:55 +0400

eblob (0.9.9) unstable; urgency=low

  * Unified on-disk search for exact match and non-removed entries
  * Generate sorted index for blobs which index is less than max index already
    found
  * Added index_size to stop iterator, if index grew under us

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 08 Aug 2011 23:34:32 +0400

eblob (0.9.8) unstable; urgency=low

  * eblob_hash_data() should use high bits untouched

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 06 Aug 2011 01:35:52 +0400

eblob (0.9.7) unstable; urgency=low

  * Get eblob_write_control from RAM only when all its fields are zeroes, so
    it is plain eblob_commit_write() call
  * Debug cleanups

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 05 Aug 2011 01:47:55 +0400

eblob (0.9.6) unstable; urgency=low

  * Do not send range replies for removed data and multiple times for objects,
    which are present on disk and in RAM

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 03 Aug 2011 21:11:53 +0400

eblob (0.9.5) unstable; urgency=low

  * Fixed old eblob iteration
  * Implemented on-disk range requests

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 02 Aug 2011 17:17:58 +0400

eblob (0.9.4) unstable; urgency=low

  * Fixed range requests (it does not iterate over on-disk index yet)
  * Mark existing index entry as removed in prepare hook

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 01 Aug 2011 21:58:11 +0400

eblob (0.9.3) unstable; urgency=low

  * We must check what bsearch() return and return error if needed.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 30 Jul 2011 01:20:56 +0400

eblob (0.9.2) unstable; urgency=low

  * When adding new column and reallocating bases we should sort base_ctls
  * Added local checksum calculation conde isntead of locked openssl

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 29 Jul 2011 23:56:49 +0400

eblob (0.9.1) unstable; urgency=low

  * configure.in udpate

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 27 Jul 2011 21:06:23 +0400

eblob (0.9.0) unstable; urgency=low

  * Export convenient prepare/commit helpers
  * Added write offsets
  * Do not remove old index
  * Search in both directions frm bsearch()-found entry when looking up key in
    on-disk sorted index
  * Refactor sorted generation code
  * Added paranoidal check about opening existing blobs for writing

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 27 Jul 2011 20:52:22 +0400

eblob (0.8.7) unstable; urgency=low

  * Create sorted indexes on startup. Use them instead of plain indexes.
  * Fixed eblob_realloc_base_type() invocation from eblob_add_new_base().
  * Fixed int overflow during lock allocation.
  * Initialize log_file_ only when we setup log_file string.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 22 Jul 2011 01:46:58 +0400

eblob (0.8.6) unstable; urgency=low

  * Log cleanups
  * Added ability to overwrite data in place
  * Fixed race between object removal and sorted index generation (not
    completely yet)

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 19 Jul 2011 22:41:18 +0400

eblob (0.8.5) unstable; urgency=low

  * Use /dev/stdout as default log file if NULL was provided in constructor
  * Implemented on-disk index
  * Added boost::regex check and compile regex iterator if it is present

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 19 Jul 2011 02:00:09 +0400

eblob (0.8.4) unstable; urgency=low

  * Added thread num param to iterator_callbacks structure

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 15 Jul 2011 19:07:40 +0400

eblob (0.8.3) unstable; urgency=low

  * Only run automatic defrag if enabled. Disabled by default.
  * Force ascending index sorting at blob loading time

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 14 Jul 2011 02:04:47 +0400

eblob (0.8.2) unstable; urgency=low

  * Use single defragmentation iterator
  * More debug

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 13 Jul 2011 21:54:36 +0400

eblob (0.8.1) unstable; urgency=low

  * If data was not compressed, but BLOB_DISK_CTL_COMPRESS flag was set,
    return data as is and clear flag
  * Do not mark the same entry as removed twice

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 13 Jul 2011 20:35:42 +0400

eblob (0.8.0) unstable; urgency=low

  * Added more checks for malformed entries. Recover index if possible.
  * Added eblob_remove_blobs(), which removes all blobs from disk. Root is
    requred to get path through /ptoc/self/fd
  * Allow eblob(struct eblob_config *cfg) constructor only, i.e. with logger
    set by caller.
  * Added automatic defragmentation

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 08 Jul 2011 03:05:26 +0400

eblob (0.7.0) unstable; urgency=low

  * Get rid of mapped file as in-memory index
  * Extended iterator interface
  * Added C++ cleanup_blobs() empty method

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 05 Jul 2011 22:01:29 +0400

eblob (0.6.1) unstable; urgency=low

  * Disable memory index in mmap file

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sun, 03 Jul 2011 02:03:48 +0400

eblob (0.6.0) unstable; urgency=low

  * Added snappy compression support.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 29 Jun 2011 03:53:56 +0400

eblob (0.5.2) unstable; urgency=low

  * Added start/max types into iterator. Exoport nice interface outside.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 28 Jun 2011 01:32:38 +0400

eblob (0.5.1) unstable; urgency=low

  * Create new files, if eblob dir is empty

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 25 Jun 2011 03:38:43 +0400

eblob (0.5.0) unstable; urgency=low

  * Added multiple columns support

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 25 Jun 2011 03:05:16 +0400

eblob (0.4.4) unstable; urgency=low

  * Added eblob_remove_hashed() and eblob::remove_hashed()

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 22 Jun 2011 20:27:12 +0400

eblob (0.4.3) unstable; urgency=low

  * Return real data offset, do not force clients to mess with sizeof(struct
    eblob_disk_control)

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 21 Jun 2011 02:45:45 +0400

eblob (0.4.2) unstable; urgency=low

  * Added hashed keys
  * Renames write methods

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sun, 19 Jun 2011 01:52:10 +0400

eblob (0.4.1) unstable; urgency=low

  * Switched to fixed-size eblob_key interface

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 18 Jun 2011 00:33:48 +0400

eblob (0.4.0) unstable; urgency=low

  * Added examples
  * Added namespace zbr
  * Do not iterate if file size is zero

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 17 Jun 2011 21:16:06 +0400

eblob (0.3.14) unstable; urgency=low

  * Added eblob range query
  * Added remove() method
  * Added c++ examples

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 16 Jun 2011 21:28:55 +0400

eblob (0.3.13) unstable; urgency=low

  * Overwrite hash entry if we asked to replace it and sizes match
  * Use (part of) provided key as hash table index
  * Preallocate more space for hash entries in a bucket
  * Save references to open data/index failes in iterator
  * Initial implementation of startup defragmentation
  * Extended eblob_iterator class to support index and data iterators

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 07 Jun 2011 12:03:49 +0400

eblob (0.3.12) unstable; urgency=low

  * Use the same mmap file for subsequent starts by default
  * Grow and start map file by 1 Gb

 -- Evgeniy Polyakov <zbr@ioremap.net>  Fri, 03 Jun 2011 07:27:19 +0400

eblob (0.3.11) unstable; urgency=low

  * Do not move entries around, since we are closing down whole mapping anyway
  * Use posix_fallocate() to preallocate sufficiently large mmap files
  * Added completion callback and matched callback counters into iterator
  * Allocate/free mmap_file and use eblob file by default as a base path for
    mmap file
  * truncate map file to 0 at cleanup

 -- Evgeniy Polyakov <zbr@ioremap.net>  Thu, 02 Jun 2011 07:24:06 +0400

eblob (0.3.10) unstable; urgency=low

  * Remap new portions of backend allocation file at different locations.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 10:52:25 +0400

eblob (0.3.9) unstable; urgency=low

  * Do not unmap map_base prior new map

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 09:18:29 +0400

eblob (0.3.8) unstable; urgency=low

  * Use mmap(MAP_FIXED)

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 09:03:39 +0400

eblob (0.3.7) unstable; urgency=low

  * Use mremap(MREMAP_FIXED | MREMAP_MAYMOVE)

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 08:51:53 +0400

eblob (0.3.6) unstable; urgency=low

  * Use munmap/mmap instead of mremap, sine the former may fail miserably

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 08:39:41 +0400

eblob (0.3.5) unstable; urgency=low

  * Fixed ostringstream and its std::string dereference

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 08:26:21 +0400

eblob (0.3.4) unstable; urgency=low

  * Added read methods
  * Use ostringstream for mmap file name

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 07:21:55 +0400

eblob (0.3.3) unstable; urgency=low

  * Added cpp bindings

 -- Evgeniy Polyakov <zbr@ioremap.net>  Wed, 01 Jun 2011 06:31:19 +0400

eblob (0.3.2) unstable; urgency=low

  * Added library version numbers

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 31 May 2011 13:29:03 +0400

eblob (0.3.1) unstable; urgency=low

  * Fixed shlibs generation

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 31 May 2011 13:02:16 +0400

eblob (0.3.0) unstable; urgency=low

  * Use mmapped file as a base for all hash entries allocations
  * Added version into debian's dh_makeshlibs
  * Moved from linked lists into arrays in eblob hash table
  * Made eblob prepare/commit more thread friendly

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 31 May 2011 09:41:19 +0400

eblob (0.2.0) unstable; urgency=low

  * Export eblob_read_file_index() which returns blob index as well as fd,
    size and offset for given record.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sat, 14 May 2011 00:38:31 +0400

eblob (0.1.7) unstable; urgency=low

  * Log level cleanups

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 01 Mar 2011 00:03:53 +0300

eblob (0.1.6) unstable; urgency=low

  * Correctly set index's disk_size to sizeof(struct eblob_disk_control)

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 28 Feb 2011 23:49:38 +0300

eblob (0.1.5) unstable; urgency=low

  * Allocate a bit more space for filename to include .index suffix.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 28 Feb 2011 23:09:19 +0300

eblob (0.1.4) unstable; urgency=low

  * Implemented run-time index generation and fixed defragmented offsets.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 15 Feb 2011 03:05:10 +0300

eblob (0.1.3) unstable; urgency=low

  * Do not lock entries in eblob_hash_insert_raw() since they should be locked
    via mlockall().

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 08 Feb 2011 02:38:28 +0300

eblob (0.1.2) unstable; urgency=low

  * Set memory locking limits to infinity if EBLOB_HASH_MLOCK is set in
    config.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 08 Feb 2011 02:31:33 +0300

eblob (0.1.1) unstable; urgency=low

  * Use mlockall(MCL_CURRENT | MCL_FUTURE) to lock all current and future
    allocations when EBLOB_HASH_MLOCK is set.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Tue, 08 Feb 2011 02:22:36 +0300

eblob (0.1.0) unstable; urgency=low

  * Switched to sha512 and 64-byte IDs

 -- Evgeniy Polyakov <zbr@ioremap.net>  Mon, 29 Nov 2010 23:43:56 +0300

eblob (0.0.1) unstable; urgency=low

  * libeblob is a low-level IO library which stores data in huge blob files appending records one after another.

 -- Evgeniy Polyakov <zbr@ioremap.net>  Sun, 28 Jul 2010 20:09:20 +0400
